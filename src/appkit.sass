
@mixin blur-behind($level, $round)
    &:before
        content: ""
        position: absolute
        z-index: -1
        -webkit-backdrop-filter: blur($level)
        backdrop-filter: blur($level)
        border-radius: $round
        top: 0
        left: 0
        right: 0
        bottom: 0

@mixin pingfang-font()
    font-family: "SF Pro Display", "PingFang SC", system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif !important

@mixin appkit-styles()
    .appkit-spinner
        display: block
        position: relative
        width: 12px
        height: 12px
        padding: 10px
        border-radius: 10px
        &.with-bg
            background: #0004
        div
            width: 5%
            height: 15%
            left: 49%
            top: 43%
            background: #444
            @media (prefers-color-scheme: dark)
                background: #FFF
                position: absolute
                animation: appkit-spinner-div-fade 1s linear infinite
                box-shadow: 0 0 3px rbga(0, 0, 0, 0.2)
                border-radius: 50px

            @keyframes appkit-spinner-div-fade
                from
                    opacity: 1
                to
                    opacity: 0

            @for $i from 0 through 11
                &:nth-child(#{$i + 1})
                    transform: rotate(30deg * $i) translateY(-130%)
                    animation-delay: calc(-1s + $i * (1s / 12))
    .appkit-now-playing-slider
        cursor: pointer
        height: 16px
        &:hover
            .thumb
                visibility: visible
        .thumb
            height: 16px
            width: 6px
            margin-top: 2px
            border-radius: 4px
            box-shadow: 0 0 3px #0008
            background: #FFFFFF
            visibility: hidden
        .track
            height: 8px
            transform: translateY(6px)
            border-radius: 4px
            background: #FFF7
            &.track-0
                background: #FFFFFFCC
    .appkit-slider
        height: 16px
        .thumb
            height: 20px
            width: 8px
            border-radius: 4px
            transform: translateY(-2px)
            background: #FFFFFF
        .track
            height: 4px
            border: 0.5px solid rgba(0, 0, 0, 0.02)
            box-shadow: 0px 0.25px 0.25px rgba(0, 0, 0, 0.15), 0px 1px 0.75px rgba(0, 0, 0, 0.05)
            transform: translateY(6px)
            border-radius: 2px
            background: rgba(0, 0, 0, 0.05)
            &.track-0
                background: #007AFF
    .appkit-button
        @include pingfang-font
        background: #6E6D70
        color: white
        border: 0.5px solid rgba(0, 0, 0, 0.12)
        box-shadow: 0px 0.5px 1px rgba(0, 0, 0, 0.1), inset 0px 0.5px 0.5px rgba(255, 255, 255, 0.5)
        border-radius: 6px
        font-size: 13px
        line-height: 16px
        font-weight: 500
        font-style: normal
        text-align: center
        min-width: 70px
        padding: 4px 14px
        cursor: pointer
        &:active
            background: #6E6D70
            color: #DFDEDF
            &.accent
                background: linear-gradient(180deg, #1568E5 0%, #155CCC 100%)
                box-shadow: 0px 0.5px 1px rgba(0, 0, 0, 0.5), inset 0px 0.5px 0px rgba(255, 255, 255, 0.25)
        &.accent
            background: linear-gradient(180deg, #4B91F7 0%, #367AF6 100%)
            box-shadow: 0px 0.5px 1.5px rgba(54, 122, 246, 0.25)
            color: white
    .appkit-switch
        @include pingfang-font
        user-select: none
        display: flex
        align-items: center
        font-size: 13px
        line-height: 16px
        &.selected > .appkit-switch-inner
            background: #007AFF
            justify-content: flex-end
            &:active
                background: linear-gradient(180deg, #155ECE 0%, #1868E5 100%)
                > *
                    background: #C8C8C8
        > .appkit-switch-inner
            // margin: 0 10px
            // width: 40px
            // height: 22px
            min-width: 27.27px
            width: 27.27px
            height: 15px
            background: rgba(0, 0, 0, 0.05)
            border: 0.5px solid rgba(0, 0, 0, 0.12)
            box-shadow: inset 0px 4px 4px rgba(0, 0, 0, 0.05)
            border-radius: 100px
            display: flex
            justify-content: flex-start
            cursor: pointer
            &:active
                background: #cdcdcd
                box-shadow: 0px 0px 1px rgba(0, 0, 0, 0.25), inset 0px 0.5px 0px rgba(255, 255, 255, 0.15)
            > *
                transform: translateY(0.5px) // 矫正居中位置
                border-radius: 50%
                width: 13px
                height: 13px
                background: #FFFFFF
                border: 0.5px solid rgba(0, 0, 0, 0.2)
                box-shadow: 0px 0.5px 4px rgba(0, 0, 0, 0.2)
    .appkit-window
        @include pingfang-font
        border-radius: 10px
        box-shadow: 0px 36px 100px rgba(0, 0, 0, 0.4), 0px 0px 3px rgba(0, 0, 0, 0.55)
        border: solid 0.5px rgba(0, 0, 0, 0.2)
        display: flex
        background: #2c2c2c
        color: rgba(255, 255, 255, 0.9)
        user-select: none
        font-style: normal
        background: rgba(44, 44, 44, 0.8)
        backdrop-filter: blur(40.7742px)
        -webkit-backdrop-filter: blur(40.7742px)
        font-size: 11px
        font-weight: 400
        max-height: 100vh
        max-width: 100vw
        -webkit-font-smoothing: antialiased
        -moz-osx-font-smoothing: grayscale
        > *
            border: solid 1px rgba(255, 255, 255, 0.2)
            border-radius: 10px
            overflow: hidden
            display: flex
            .spacer
                flex: 1
            .window-sidebar
                flex: 0
                display: flex
                flex-direction: column
                margin-bottom: 17px
                .sidebar-item
                    font-weight: 400
                    font-size: 13px
                    line-height: 16px
                    margin: 0px 17px
                    white-space: nowrap
                    >*
                        padding: 6px 7px
                        border-radius: 5px
                    &.selected>*
                        background: linear-gradient(0deg, rgba(10, 130, 255, 0.75), rgba(10, 130, 255, 0.75)), #0A82FF
            .window-sidebar-devider
                width: 1px
                min-width: 1px
                background: rgba(255, 255, 255, 0.1)
                box-shadow: -1px 0px 0.5px rgba(0, 0, 0, 0.05)
            .window-content
                background: #2c2c2c
                flex: 1
                min-width: 0
                min-height: 0
                display: flex
                flex-direction: column
                .window-content-inner
                    flex: 1
                    min-height: 0
                    min-width: 0
                    >*
                        position: relative
                        overflow: hidden scroll
                        width: 100%
                        height: 100%
                        >*
                            max-width: 100%
                            height: fit-content
                            margin: 0px 20px 20px 20px
            .window-controls-content
                flex: 0
                display: flex
                min-height: 52px
                align-items: center
                &.small
                    min-height: 24px // 小窗口
            .title
                margin: 0 30px
                font-size: 15px
                font-weight: 590
            .appkit-traffic-lights
                position: absolute
                display: flex
                margin: 20px // 大窗口
                &:hover > button
                    &.close
                        background-image: url("data:image/svg+xml,%3Csvg width='6' height='6' viewBox='0 0 6 6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0.5 0.5L5.5 5.5M5.5 0.5L0.5 5.5' stroke='black' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E%0A")
                    &.minimize
                        background-image: url("data:image/svg+xml,%3Csvg width='8' height='2' viewBox='0 0 8 2' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0.75 1H7.25' stroke='black' stroke-opacity='0.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E%0A")
                    &.zoom
                        background-image: url("data:image/svg+xml,%3Csvg width='6' height='6' viewBox='0 0 6 6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4.49999 -1.35601e-05L-6.78003e-06 4.49999V-6.78003e-06L4.49999 -1.35601e-05Z' fill='black' fill-opacity='0.5'/%3E%3Cpath d='M1.49999 5.99999L5.99999 1.49999L6 6L1.49999 5.99999Z' fill='black' fill-opacity='0.5'/%3E%3C/svg%3E%0A")
                &.small
                    margin: 6px // 小窗口
                button
                    display: block
                    border: 0.5px solid rgba(0, 0, 0, 0.2)
                    height: 12px
                    width: 12px
                    margin-right: 8px
                    border-radius: 6px
                    background-position: center
                    background-repeat: no-repeat
                    padding: 0
                    &.close
                        background-color: #FF5F57
                    &.minimize
                        background-color: #FEBC2E
                    &.zoom
                        background-color: #28C840
    .appkit-group-box
        background: rgba(255, 255, 255, 0.05)
        border: 1px solid rgba(255, 255, 255, 0.05)
        border-radius: 6px
        padding: 10px
        margin-bottom: 16px
    .appkit-group-box-devider
        border-bottom: 1px solid rgba(255, 255, 255, 0.05)
        margin: 8px 0

    .appkit-menu
        @include pingfang-font
        z-index: 999
        background: rgba(40, 40, 40, 0.6)
        border: 0.5px solid rgba(0, 0, 0, 0.7)
        box-shadow: 0px 4px 20px rgba(0, 0, 0, 0.25)
        border-radius: 6px
        max-height: 80vh
        width: fit-content
        pointer-events: none
        overflow-y: scroll
        &::-webkit-scrollbar
            display: none
        @include blur-behind(16px, 6px)
        > *
            border: 1px solid rgba(255, 255, 255, 0.3)
            padding: 5px 0
            border-radius: 6px
            cursor: default

        &.is-submenu
            position: fixed
        //     &.side-right
        //         margin-left: -6px
        //         left: 100%
        //     &.side-left
        //         margin-right: -6px
        //         right: 100%
        //     &.direction-down
        //         top: 0
        //         margin-top: -9px
        //     &.direction-up
        //         bottom: 0
        //         margin-bottom: -9px
        //     &.direction-center
        //         height: 80%
        &.hide
            visibility: hidden

        &.with-checkbox > *
            > .appkit-menu-item
                padding-left: 22px
                &.checked
                    background-image: url("data:image/svg+xml,%3Csvg width='13' height='14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg filter='url(%23prefix__filter0_d_416_340)'%3E%3Cpath d='M3 8l2.25 2.5L9.5 4' stroke='%23fff' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/g%3E%3Cdefs%3E%3Cfilter id='prefix__filter0_d_416_340' x='1.75' y='3.25' width='9' height='9' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3E%3CfeFlood flood-opacity='0' result='BackgroundImageFix'/%3E%3CfeColorMatrix in='SourceAlpha' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3E%3CfeOffset dy='.5'/%3E%3CfeGaussianBlur stdDeviation='.25'/%3E%3CfeColorMatrix values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0'/%3E%3CfeBlend in2='BackgroundImageFix' result='effect1_dropShadow_416_340'/%3E%3CfeBlend in='SourceGraphic' in2='effect1_dropShadow_416_340' result='shape'/%3E%3C/filter%3E%3C/defs%3E%3C/svg%3E")
                    background-repeat: no-repeat
                    background-position-y: center
                    background-position-x: 5px + 3px
            > .appkit-menu-item-devider
                margin-left: 11px

    .appkit-menu-item
        padding: 2px (9px + 5px)
        box-sizing: border-box
        display: block
        width: 100%
        text-align: left
        background: transparent
        border: none
        font-size: 13px
        line-height: 18px
        color: white
        font-style: normal
        font-weight: 400
        user-select: none
        cursor: default
        pointer-events: visibleFill
        &.has-submenu
            position: relative
        &.label-only
            opacity: 0.75
        &:hover
            &:not(.label-only)::before
                content: " "
                position: absolute
                z-index: -1
                width: calc(100% - 10px)
                left: 5px
                margin-top: -3px
                height: 18px + 5px
                background: #0A84FF
                border-radius: 4px
                pointer-events: none

    .appkit-menu-item-devider
        margin: 5px 9px
        height: 1px
        background: rgba(255, 255, 255, 0.3)

@include appkit-styles()
