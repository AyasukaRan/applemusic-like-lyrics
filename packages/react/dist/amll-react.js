"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const y=require("react/jsx-runtime"),L=require("@applemusic-like-lyrics/core"),r=require("react"),A=require("react-dom"),k=r.forwardRef(({albumImageUrl:l,fps:d,playing:E,flowSpeed:o,renderScale:a,staticMode:v,...p},w)=>{const n=r.useRef(),i=r.useRef(null);return r.useEffect(()=>(n.current=new L.BackgroundRender,()=>{var u;(u=n.current)==null||u.dispose()}),[]),r.useEffect(()=>{var u;l&&((u=n.current)==null||u.setAlbumImage(l))},[l]),r.useEffect(()=>{var u;d&&((u=n.current)==null||u.setFPS(d))},[d]),r.useEffect(()=>{var u,f,R;E===void 0?(u=n.current)==null||u.resume():E?(f=n.current)==null||f.resume():(R=n.current)==null||R.pause()},[E]),r.useEffect(()=>{var u;o&&((u=n.current)==null||u.setFlowSpeed(o))},[o]),r.useEffect(()=>{var u;(u=n.current)==null||u.setStaticMode(v)},[v]),r.useEffect(()=>{var u;a&&((u=n.current)==null||u.setRenderScale(a))},[a]),r.useEffect(()=>{var u;if(n.current){const f=n.current.getElement();f.style.width="100%",f.style.height="100%",(u=i.current)==null||u.appendChild(f)}}),r.useImperativeHandle(w,()=>({wrapperEl:i.current,bgRender:n.current}),[i.current,n.current]),y.jsx("div",{...p,ref:i})}),H=r.forwardRef(({disabled:l,alignAnchor:d,alignPosition:E,enableSpring:o,enableBlur:a,enableScale:v,lyricLines:p,currentTime:w,linePosXSpringParams:n,linePosYSpringParams:i,lineScaleSpringParams:u,bottomLine:f,onLyricLineClick:R,onLyricLineContextMenu:q,...g},x)=>{var B,F;const t=r.useRef(),h=r.useRef(null);return r.useEffect(()=>(t.current=new L.LyricPlayer,()=>{var e;(e=t.current)==null||e.dispose()}),[]),r.useEffect(()=>{if(!l){let e=!1,c=-1;const s=m=>{var j;e||(c===-1&&(c=m),(j=t.current)==null||j.update(m-c),c=m,requestAnimationFrame(s))};return requestAnimationFrame(s),()=>{e=!0}}},[l]),r.useEffect(()=>{var e;t.current&&((e=h.current)==null||e.appendChild(t.current.getElement()))},[h.current]),r.useEffect(()=>{var e;d!==void 0&&((e=t.current)==null||e.setAlignAnchor(d))},[d]),r.useEffect(()=>{var e;E!==void 0&&((e=t.current)==null||e.setAlignPosition(E))},[E]),r.useEffect(()=>{var e,c;o!==void 0?(e=t.current)==null||e.setEnableSpring(o):(c=t.current)==null||c.setEnableSpring(!0)},[o]),r.useEffect(()=>{var e,c;v!==void 0?(e=t.current)==null||e.setEnableScale(v):(c=t.current)==null||c.setEnableScale(!0)},[v]),r.useEffect(()=>{var e;(e=t.current)==null||e.setEnableBlur(a??!0)},[a]),r.useEffect(()=>{var e,c,s,m;p!==void 0?((e=t.current)==null||e.setLyricLines(p),(c=t.current)==null||c.update()):((s=t.current)==null||s.setLyricLines([]),(m=t.current)==null||m.update())},[p]),r.useEffect(()=>{var e,c;w!==void 0?(e=t.current)==null||e.setCurrentTime(w):(c=t.current)==null||c.setCurrentTime(0)},[w]),r.useEffect(()=>{var e;n!==void 0&&((e=t.current)==null||e.setLinePosXSpringParams(n))},[n]),r.useEffect(()=>{var e;i!==void 0&&((e=t.current)==null||e.setLinePosYSpringParams(i))},[i]),r.useEffect(()=>{var e;u!==void 0&&((e=t.current)==null||e.setLineScaleSpringParams(u))},[u]),r.useEffect(()=>{var e;if(R){const c=s=>R(s);return(e=t.current)==null||e.addEventListener("line-click",c),()=>{var s;return(s=t.current)==null?void 0:s.removeEventListener("line-click",c)}}},[R]),r.useEffect(()=>{var e;if(q){const c=s=>q(s);return(e=t.current)==null||e.addEventListener("line-contextmenu",c),()=>{var s;return(s=t.current)==null?void 0:s.removeEventListener("line-contextmenu",c)}}},[q]),r.useImperativeHandle(x,()=>({wrapperEl:h.current,lyricPlayer:t.current}),[h.current,t.current]),y.jsxs(y.Fragment,{children:[y.jsx("div",{...g,ref:h}),(B=t.current)!=null&&B.getBottomLineElement()&&f?A.createPortal(f,(F=t.current)==null?void 0:F.getBottomLineElement()):null]})});exports.BackgroundRender=k;exports.LyricPlayer=H;
//# sourceMappingURL=amll-react.js.map
