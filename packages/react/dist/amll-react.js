"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const y=require("react/jsx-runtime"),j=require("@applemusic-like-lyrics/core"),r=require("react"),x=require("react-dom"),A=r.forwardRef(({albumImageUrl:l,fps:E,playing:d,flowSpeed:o,renderScale:a,staticMode:R,...v},w)=>{const n=r.useRef(),i=r.useRef(null);return r.useEffect(()=>(n.current=new j.BackgroundRender,()=>{var u;(u=n.current)==null||u.dispose()}),[]),r.useEffect(()=>{var u;l&&((u=n.current)==null||u.setAlbumImage(l))},[l]),r.useEffect(()=>{var u;E&&((u=n.current)==null||u.setFPS(E))},[E]),r.useEffect(()=>{var u,f,m;d===void 0?(u=n.current)==null||u.resume():d?(f=n.current)==null||f.resume():(m=n.current)==null||m.pause()},[d]),r.useEffect(()=>{var u;o&&((u=n.current)==null||u.setFlowSpeed(o))},[o]),r.useEffect(()=>{var u;(u=n.current)==null||u.setStaticMode(R)},[R]),r.useEffect(()=>{var u;a&&((u=n.current)==null||u.setRenderScale(a))},[a]),r.useEffect(()=>{var u;if(n.current){const f=n.current.getElement();f.style.width="100%",f.style.height="100%",(u=i.current)==null||u.appendChild(f)}}),r.useImperativeHandle(w,()=>({wrapperEl:i.current,bgRender:n.current}),[i.current,n.current]),y.jsx("div",{...v,ref:i})}),k=r.forwardRef(({disabled:l,alignAnchor:E,alignPosition:d,enableSpring:o,enableBlur:a,lyricLines:R,currentTime:v,linePosXSpringParams:w,linePosYSpringParams:n,lineScaleSpringParams:i,bottomLine:u,onLyricLineClick:f,onLyricLineContextMenu:m,...L},g)=>{var q,B;const t=r.useRef(),h=r.useRef(null);return r.useEffect(()=>(t.current=new j.LyricPlayer,()=>{var e;(e=t.current)==null||e.dispose()}),[]),r.useEffect(()=>{if(!l){let e=!1,c=-1;const s=p=>{var F;e||(c===-1&&(c=p),(F=t.current)==null||F.update(p-c),c=p,requestAnimationFrame(s))};return requestAnimationFrame(s),()=>{e=!0}}},[l]),r.useEffect(()=>{var e;t.current&&((e=h.current)==null||e.appendChild(t.current.getElement()))},[h.current]),r.useEffect(()=>{var e;E&&((e=t.current)==null||e.setAlignAnchor(E))},[E]),r.useEffect(()=>{var e;d&&((e=t.current)==null||e.setAlignPosition(d))},[d]),r.useEffect(()=>{var e,c;o?(e=t.current)==null||e.setEnableSpring(o):(c=t.current)==null||c.setEnableSpring(!0)},[o]),r.useEffect(()=>{var e;(e=t.current)==null||e.setEnableBlur(a??!0)},[a]),r.useEffect(()=>{var e,c,s,p;R?((e=t.current)==null||e.setLyricLines(R),(c=t.current)==null||c.update()):((s=t.current)==null||s.setLyricLines([]),(p=t.current)==null||p.update())},[R]),r.useEffect(()=>{var e,c;v?(e=t.current)==null||e.setCurrentTime(v):(c=t.current)==null||c.setCurrentTime(0)},[v]),r.useEffect(()=>{var e;w&&((e=t.current)==null||e.setLinePosXSpringParams(w))},[w]),r.useEffect(()=>{var e;n&&((e=t.current)==null||e.setLinePosYSpringParams(n))},[n]),r.useEffect(()=>{var e;i&&((e=t.current)==null||e.setLineScaleSpringParams(i))},[i]),r.useEffect(()=>{var e;if(f){const c=s=>f(s);return(e=t.current)==null||e.addEventListener("line-click",c),()=>{var s;return(s=t.current)==null?void 0:s.removeEventListener("line-click",c)}}},[f]),r.useEffect(()=>{var e;if(m){const c=s=>m(s);return(e=t.current)==null||e.addEventListener("line-contextmenu",c),()=>{var s;return(s=t.current)==null?void 0:s.removeEventListener("line-contextmenu",c)}}},[m]),r.useImperativeHandle(g,()=>({wrapperEl:h.current,lyricPlayer:t.current}),[h.current,t.current]),y.jsxs(y.Fragment,{children:[y.jsx("div",{...L,ref:h}),(q=t.current)!=null&&q.getBottomLineElement()&&u?x.createPortal(u,(B=t.current)==null?void 0:B.getBottomLineElement()):null]})});exports.BackgroundRender=A;exports.LyricPlayer=k;
//# sourceMappingURL=amll-react.js.map
