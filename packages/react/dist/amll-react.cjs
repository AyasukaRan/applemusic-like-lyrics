"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=require("react/jsx-runtime"),k=require("@applemusic-like-lyrics/core"),t=require("react"),P=require("react-dom"),T=t.forwardRef(({albumImageUrl:l,fps:i,playing:E,flowSpeed:d,renderScale:o,staticMode:F,lowFreqVolume:m,hasLyric:p,renderer:w,...j},q)=>{const c=t.useRef(),a=t.useRef(null);return t.useEffect(()=>{var u,f,v,H,L,r,R,A;return c.current=k.BackgroundRender.new(w??k.EplorRenderer),l&&((u=c.current)==null||u.setAlbumImage(l)),i&&((f=c.current)==null||f.setFPS(i)),E===void 0?(v=c.current)==null||v.resume():E?(H=c.current)==null||H.resume():(L=c.current)==null||L.pause(),d&&((r=c.current)==null||r.setFlowSpeed(d)),(R=c.current)==null||R.setStaticMode(F??!1),o&&((A=c.current)==null||A.setRenderScale(o??.5)),()=>{var x;(x=c.current)==null||x.dispose()}},[w]),t.useEffect(()=>{var u;l&&((u=c.current)==null||u.setAlbumImage(l))},[l]),t.useEffect(()=>{var u;i&&((u=c.current)==null||u.setFPS(i))},[i]),t.useEffect(()=>{var u,f,v;E===void 0?(u=c.current)==null||u.resume():E?(f=c.current)==null||f.resume():(v=c.current)==null||v.pause()},[E]),t.useEffect(()=>{var u;d&&((u=c.current)==null||u.setFlowSpeed(d))},[d]),t.useEffect(()=>{var u;(u=c.current)==null||u.setStaticMode(F??!1)},[F]),t.useEffect(()=>{var u;o&&((u=c.current)==null||u.setRenderScale(o??.5))},[o]),t.useEffect(()=>{var u;m&&((u=c.current)==null||u.setLowFreqVolume(m??1))},[m]),t.useEffect(()=>{var u;p!==void 0&&((u=c.current)==null||u.setHasLyric(p??!0))},[p]),t.useEffect(()=>{var u;if(c.current){const f=c.current.getElement();f.style.width="100%",f.style.height="100%",(u=a.current)==null||u.appendChild(f)}},[c.current]),t.useImperativeHandle(q,()=>({wrapperEl:a.current,bgRender:c.current}),[a.current,c.current]),h.jsx("div",{...j,ref:a})}),D=t.forwardRef(({disabled:l,playing:i,alignAnchor:E,alignPosition:d,enableSpring:o,enableBlur:F,enableScale:m,hidePassedLines:p,lyricLines:w,currentTime:j,linePosXSpringParams:q,linePosYSpringParams:c,lineScaleSpringParams:a,bottomLine:u,onLyricLineClick:f,onLyricLineContextMenu:v,...H},L)=>{var A,x;const r=t.useRef(),R=t.useRef(null);return t.useEffect(()=>(r.current=new k.LyricPlayer,()=>{var e;(e=r.current)==null||e.dispose()}),[]),t.useEffect(()=>{if(!l){let e=!1,n=-1;const s=B=>{var y;e||(n===-1&&(n=B),(y=r.current)==null||y.update(B-n),n=B,requestAnimationFrame(s))};return requestAnimationFrame(s),()=>{e=!0}}},[l]),t.useEffect(()=>{var e,n,s;i!==void 0?i?(e=r.current)==null||e.resume():(n=r.current)==null||n.pause():(s=r.current)==null||s.resume()},[i]),t.useEffect(()=>{var e;r.current&&((e=R.current)==null||e.appendChild(r.current.getElement()))},[R.current]),t.useEffect(()=>{var e;E!==void 0&&((e=r.current)==null||e.setAlignAnchor(E))},[E]),t.useEffect(()=>{var e;p!==void 0&&((e=r.current)==null||e.setHidePassedLines(p))},[p]),t.useEffect(()=>{var e;d!==void 0&&((e=r.current)==null||e.setAlignPosition(d))},[d]),t.useEffect(()=>{var e,n;o!==void 0?(e=r.current)==null||e.setEnableSpring(o):(n=r.current)==null||n.setEnableSpring(!0)},[o]),t.useEffect(()=>{var e,n;m!==void 0?(e=r.current)==null||e.setEnableScale(m):(n=r.current)==null||n.setEnableScale(!0)},[m]),t.useEffect(()=>{var e;(e=r.current)==null||e.setEnableBlur(F??!0)},[F]),t.useEffect(()=>{var e,n,s,B;w!==void 0?((e=r.current)==null||e.setLyricLines(w),(n=r.current)==null||n.update()):((s=r.current)==null||s.setLyricLines([]),(B=r.current)==null||B.update())},[w]),t.useEffect(()=>{var e,n;j!==void 0?(e=r.current)==null||e.setCurrentTime(j):(n=r.current)==null||n.setCurrentTime(0)},[j]),t.useEffect(()=>{var e;q!==void 0&&((e=r.current)==null||e.setLinePosXSpringParams(q))},[q]),t.useEffect(()=>{var e;c!==void 0&&((e=r.current)==null||e.setLinePosYSpringParams(c))},[c]),t.useEffect(()=>{var e;a!==void 0&&((e=r.current)==null||e.setLineScaleSpringParams(a))},[a]),t.useEffect(()=>{var e;if(f){const n=s=>f(s);return(e=r.current)==null||e.addEventListener("line-click",n),()=>{var s;return(s=r.current)==null?void 0:s.removeEventListener("line-click",n)}}},[f]),t.useEffect(()=>{var e;if(v){const n=s=>v(s);return(e=r.current)==null||e.addEventListener("line-contextmenu",n),()=>{var s;return(s=r.current)==null?void 0:s.removeEventListener("line-contextmenu",n)}}},[v]),t.useImperativeHandle(L,()=>({wrapperEl:R.current,lyricPlayer:r.current}),[R.current,r.current]),h.jsxs(h.Fragment,{children:[h.jsx("div",{...H,ref:R}),(A=r.current)!=null&&A.getBottomLineElement()&&u?P.createPortal(u,(x=r.current)==null?void 0:x.getBottomLineElement()):null]})});exports.BackgroundRender=T;exports.LyricPlayer=D;
//# sourceMappingURL=amll-react.cjs.map
