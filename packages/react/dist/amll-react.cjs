"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const y=require("react/jsx-runtime"),A=require("@applemusic-like-lyrics/core"),t=require("react"),H=require("react-dom"),P=t.forwardRef(({albumImageUrl:l,fps:i,playing:E,flowSpeed:d,renderScale:v,staticMode:m,renderer:p,...q},B)=>{const u=t.useRef(),a=t.useRef(null);return t.useEffect(()=>{var c,f,o,F,j,x,r,R;return u.current=A.BackgroundRender.new(p??A.PixiRenderer),l&&((c=u.current)==null||c.setAlbumImage(l)),i&&((f=u.current)==null||f.setFPS(i)),E===void 0?(o=u.current)==null||o.resume():E?(F=u.current)==null||F.resume():(j=u.current)==null||j.pause(),d&&((x=u.current)==null||x.setFlowSpeed(d)),(r=u.current)==null||r.setStaticMode(m??!1),v&&((R=u.current)==null||R.setRenderScale(v??.5)),()=>{var h;(h=u.current)==null||h.dispose()}},[p]),t.useEffect(()=>{var c;l&&((c=u.current)==null||c.setAlbumImage(l))},[l]),t.useEffect(()=>{var c;i&&((c=u.current)==null||c.setFPS(i))},[i]),t.useEffect(()=>{var c,f,o;E===void 0?(c=u.current)==null||c.resume():E?(f=u.current)==null||f.resume():(o=u.current)==null||o.pause()},[E]),t.useEffect(()=>{var c;d&&((c=u.current)==null||c.setFlowSpeed(d))},[d]),t.useEffect(()=>{var c;(c=u.current)==null||c.setStaticMode(m??!1)},[m]),t.useEffect(()=>{var c;v&&((c=u.current)==null||c.setRenderScale(v??.5))},[v]),t.useEffect(()=>{var c;if(u.current){const f=u.current.getElement();f.style.width="100%",f.style.height="100%",(c=a.current)==null||c.appendChild(f)}},[u.current]),t.useImperativeHandle(B,()=>({wrapperEl:a.current,bgRender:u.current}),[a.current,u.current]),y.jsx("div",{...q,ref:a})}),T=t.forwardRef(({disabled:l,alignAnchor:i,alignPosition:E,enableSpring:d,enableBlur:v,enableScale:m,hidePassedLines:p,lyricLines:q,currentTime:B,linePosXSpringParams:u,linePosYSpringParams:a,lineScaleSpringParams:c,bottomLine:f,onLyricLineClick:o,onLyricLineContextMenu:F,...j},x)=>{var h,L;const r=t.useRef(),R=t.useRef(null);return t.useEffect(()=>(r.current=new A.LyricPlayer,()=>{var e;(e=r.current)==null||e.dispose()}),[]),t.useEffect(()=>{if(!l){let e=!1,n=-1;const s=w=>{var k;e||(n===-1&&(n=w),(k=r.current)==null||k.update(w-n),n=w,requestAnimationFrame(s))};return requestAnimationFrame(s),()=>{e=!0}}},[l]),t.useEffect(()=>{var e;r.current&&((e=R.current)==null||e.appendChild(r.current.getElement()))},[R.current]),t.useEffect(()=>{var e;i!==void 0&&((e=r.current)==null||e.setAlignAnchor(i))},[i]),t.useEffect(()=>{var e;p!==void 0&&((e=r.current)==null||e.setHidePassedLines(p))},[p]),t.useEffect(()=>{var e;E!==void 0&&((e=r.current)==null||e.setAlignPosition(E))},[E]),t.useEffect(()=>{var e,n;d!==void 0?(e=r.current)==null||e.setEnableSpring(d):(n=r.current)==null||n.setEnableSpring(!0)},[d]),t.useEffect(()=>{var e,n;m!==void 0?(e=r.current)==null||e.setEnableScale(m):(n=r.current)==null||n.setEnableScale(!0)},[m]),t.useEffect(()=>{var e;(e=r.current)==null||e.setEnableBlur(v??!0)},[v]),t.useEffect(()=>{var e,n,s,w;q!==void 0?((e=r.current)==null||e.setLyricLines(q),(n=r.current)==null||n.update()):((s=r.current)==null||s.setLyricLines([]),(w=r.current)==null||w.update())},[q]),t.useEffect(()=>{var e,n;B!==void 0?(e=r.current)==null||e.setCurrentTime(B):(n=r.current)==null||n.setCurrentTime(0)},[B]),t.useEffect(()=>{var e;u!==void 0&&((e=r.current)==null||e.setLinePosXSpringParams(u))},[u]),t.useEffect(()=>{var e;a!==void 0&&((e=r.current)==null||e.setLinePosYSpringParams(a))},[a]),t.useEffect(()=>{var e;c!==void 0&&((e=r.current)==null||e.setLineScaleSpringParams(c))},[c]),t.useEffect(()=>{var e;if(o){const n=s=>o(s);return(e=r.current)==null||e.addEventListener("line-click",n),()=>{var s;return(s=r.current)==null?void 0:s.removeEventListener("line-click",n)}}},[o]),t.useEffect(()=>{var e;if(F){const n=s=>F(s);return(e=r.current)==null||e.addEventListener("line-contextmenu",n),()=>{var s;return(s=r.current)==null?void 0:s.removeEventListener("line-contextmenu",n)}}},[F]),t.useImperativeHandle(x,()=>({wrapperEl:R.current,lyricPlayer:r.current}),[R.current,r.current]),y.jsxs(y.Fragment,{children:[y.jsx("div",{...j,ref:R}),(h=r.current)!=null&&h.getBottomLineElement()&&f?H.createPortal(f,(L=r.current)==null?void 0:L.getBottomLineElement()):null]})});exports.BackgroundRender=P;exports.LyricPlayer=T;
//# sourceMappingURL=amll-react.cjs.map
