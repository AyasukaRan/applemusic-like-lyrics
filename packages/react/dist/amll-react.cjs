"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const H=require("react/jsx-runtime"),L=require("@applemusic-like-lyrics/core"),r=require("react"),k=require("react-dom"),P=r.forwardRef(({albumImageUrl:o,fps:i,playing:E,flowSpeed:d,renderScale:v,staticMode:a,lowFreqVolume:R,hasLyric:m,renderer:w,...j},q)=>{const c=r.useRef(),p=r.useRef(null);return r.useEffect(()=>{var t,s,F,y,u,l,x,A;return c.current=L.BackgroundRender.new(w??L.PixiRenderer),o&&((t=c.current)==null||t.setAlbumImage(o)),i&&((s=c.current)==null||s.setFPS(i)),E===void 0?(F=c.current)==null||F.resume():E?(y=c.current)==null||y.resume():(u=c.current)==null||u.pause(),d&&((l=c.current)==null||l.setFlowSpeed(d)),(x=c.current)==null||x.setStaticMode(a??!1),v&&((A=c.current)==null||A.setRenderScale(v??.5)),()=>{var e;(e=c.current)==null||e.dispose()}},[w]),r.useEffect(()=>{var t;o&&((t=c.current)==null||t.setAlbumImage(o))},[o]),r.useEffect(()=>{var t;i&&((t=c.current)==null||t.setFPS(i))},[i]),r.useEffect(()=>{var t,s,F;E===void 0?(t=c.current)==null||t.resume():E?(s=c.current)==null||s.resume():(F=c.current)==null||F.pause()},[E]),r.useEffect(()=>{var t;d&&((t=c.current)==null||t.setFlowSpeed(d))},[d]),r.useEffect(()=>{var t;(t=c.current)==null||t.setStaticMode(a??!1)},[a]),r.useEffect(()=>{var t;v&&((t=c.current)==null||t.setRenderScale(v??.5))},[v]),r.useEffect(()=>{var t;R&&((t=c.current)==null||t.setLowFreqVolume(R??1))},[R]),r.useEffect(()=>{var t;m!==void 0&&((t=c.current)==null||t.setHasLyric(m??!0))},[m]),r.useEffect(()=>{var t;if(c.current){const s=c.current.getElement();s.style.width="100%",s.style.height="100%",(t=p.current)==null||t.appendChild(s)}},[c.current]),r.useImperativeHandle(q,()=>({wrapperEl:p.current,bgRender:c.current}),[p.current,c.current]),H.jsx("div",{...j,ref:p})}),T=r.forwardRef(({disabled:o,alignAnchor:i,alignPosition:E,enableSpring:d,enableBlur:v,enableScale:a,hidePassedLines:R,lyricLines:m,currentTime:w,linePosXSpringParams:j,linePosYSpringParams:q,lineScaleSpringParams:c,bottomLine:p,onLyricLineClick:t,onLyricLineContextMenu:s,...F},y)=>{var x,A;const u=r.useRef(),l=r.useRef(null);return r.useEffect(()=>(u.current=new L.LyricPlayer,()=>{var e;(e=u.current)==null||e.dispose()}),[]),r.useEffect(()=>{if(!o){let e=!1,n=-1;const f=B=>{var h;e||(n===-1&&(n=B),(h=u.current)==null||h.update(B-n),n=B,requestAnimationFrame(f))};return requestAnimationFrame(f),()=>{e=!0}}},[o]),r.useEffect(()=>{var e;u.current&&((e=l.current)==null||e.appendChild(u.current.getElement()))},[l.current]),r.useEffect(()=>{var e;i!==void 0&&((e=u.current)==null||e.setAlignAnchor(i))},[i]),r.useEffect(()=>{var e;R!==void 0&&((e=u.current)==null||e.setHidePassedLines(R))},[R]),r.useEffect(()=>{var e;E!==void 0&&((e=u.current)==null||e.setAlignPosition(E))},[E]),r.useEffect(()=>{var e,n;d!==void 0?(e=u.current)==null||e.setEnableSpring(d):(n=u.current)==null||n.setEnableSpring(!0)},[d]),r.useEffect(()=>{var e,n;a!==void 0?(e=u.current)==null||e.setEnableScale(a):(n=u.current)==null||n.setEnableScale(!0)},[a]),r.useEffect(()=>{var e;(e=u.current)==null||e.setEnableBlur(v??!0)},[v]),r.useEffect(()=>{var e,n,f,B;m!==void 0?((e=u.current)==null||e.setLyricLines(m),(n=u.current)==null||n.update()):((f=u.current)==null||f.setLyricLines([]),(B=u.current)==null||B.update())},[m]),r.useEffect(()=>{var e,n;w!==void 0?(e=u.current)==null||e.setCurrentTime(w):(n=u.current)==null||n.setCurrentTime(0)},[w]),r.useEffect(()=>{var e;j!==void 0&&((e=u.current)==null||e.setLinePosXSpringParams(j))},[j]),r.useEffect(()=>{var e;q!==void 0&&((e=u.current)==null||e.setLinePosYSpringParams(q))},[q]),r.useEffect(()=>{var e;c!==void 0&&((e=u.current)==null||e.setLineScaleSpringParams(c))},[c]),r.useEffect(()=>{var e;if(t){const n=f=>t(f);return(e=u.current)==null||e.addEventListener("line-click",n),()=>{var f;return(f=u.current)==null?void 0:f.removeEventListener("line-click",n)}}},[t]),r.useEffect(()=>{var e;if(s){const n=f=>s(f);return(e=u.current)==null||e.addEventListener("line-contextmenu",n),()=>{var f;return(f=u.current)==null?void 0:f.removeEventListener("line-contextmenu",n)}}},[s]),r.useImperativeHandle(y,()=>({wrapperEl:l.current,lyricPlayer:u.current}),[l.current,u.current]),H.jsxs(H.Fragment,{children:[H.jsx("div",{...F,ref:l}),(x=u.current)!=null&&x.getBottomLineElement()&&p?k.createPortal(p,(A=u.current)==null?void 0:A.getBottomLineElement()):null]})});exports.BackgroundRender=P;exports.LyricPlayer=T;
//# sourceMappingURL=amll-react.cjs.map
