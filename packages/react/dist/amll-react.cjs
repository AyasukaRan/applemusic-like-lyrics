"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const A=require("react/jsx-runtime"),L=require("@applemusic-like-lyrics/core"),t=require("react"),H=require("react-dom"),P=t.forwardRef(({albumImageUrl:v,fps:i,playing:E,flowSpeed:d,renderScale:l,staticMode:m,lowFreqVolume:p,renderer:F,...B},h)=>{const c=t.useRef(),a=t.useRef(null);return t.useEffect(()=>{var u,f,o,x,y,r,R,j;return c.current=L.BackgroundRender.new(F??L.PixiRenderer),v&&((u=c.current)==null||u.setAlbumImage(v)),i&&((f=c.current)==null||f.setFPS(i)),E===void 0?(o=c.current)==null||o.resume():E?(x=c.current)==null||x.resume():(y=c.current)==null||y.pause(),d&&((r=c.current)==null||r.setFlowSpeed(d)),(R=c.current)==null||R.setStaticMode(m??!1),l&&((j=c.current)==null||j.setRenderScale(l??.5)),()=>{var q;(q=c.current)==null||q.dispose()}},[F]),t.useEffect(()=>{var u;v&&((u=c.current)==null||u.setAlbumImage(v))},[v]),t.useEffect(()=>{var u;i&&((u=c.current)==null||u.setFPS(i))},[i]),t.useEffect(()=>{var u,f,o;E===void 0?(u=c.current)==null||u.resume():E?(f=c.current)==null||f.resume():(o=c.current)==null||o.pause()},[E]),t.useEffect(()=>{var u;d&&((u=c.current)==null||u.setFlowSpeed(d))},[d]),t.useEffect(()=>{var u;(u=c.current)==null||u.setStaticMode(m??!1)},[m]),t.useEffect(()=>{var u;l&&((u=c.current)==null||u.setRenderScale(l??.5))},[l]),t.useEffect(()=>{var u;p&&((u=c.current)==null||u.setLowFreqVolume(p??1))},[p]),t.useEffect(()=>{var u;if(c.current){const f=c.current.getElement();f.style.width="100%",f.style.height="100%",(u=a.current)==null||u.appendChild(f)}},[c.current]),t.useImperativeHandle(h,()=>({wrapperEl:a.current,bgRender:c.current}),[a.current,c.current]),A.jsx("div",{...B,ref:a})}),T=t.forwardRef(({disabled:v,alignAnchor:i,alignPosition:E,enableSpring:d,enableBlur:l,enableScale:m,hidePassedLines:p,lyricLines:F,currentTime:B,linePosXSpringParams:h,linePosYSpringParams:c,lineScaleSpringParams:a,bottomLine:u,onLyricLineClick:f,onLyricLineContextMenu:o,...x},y)=>{var j,q;const r=t.useRef(),R=t.useRef(null);return t.useEffect(()=>(r.current=new L.LyricPlayer,()=>{var e;(e=r.current)==null||e.dispose()}),[]),t.useEffect(()=>{if(!v){let e=!1,n=-1;const s=w=>{var k;e||(n===-1&&(n=w),(k=r.current)==null||k.update(w-n),n=w,requestAnimationFrame(s))};return requestAnimationFrame(s),()=>{e=!0}}},[v]),t.useEffect(()=>{var e;r.current&&((e=R.current)==null||e.appendChild(r.current.getElement()))},[R.current]),t.useEffect(()=>{var e;i!==void 0&&((e=r.current)==null||e.setAlignAnchor(i))},[i]),t.useEffect(()=>{var e;p!==void 0&&((e=r.current)==null||e.setHidePassedLines(p))},[p]),t.useEffect(()=>{var e;E!==void 0&&((e=r.current)==null||e.setAlignPosition(E))},[E]),t.useEffect(()=>{var e,n;d!==void 0?(e=r.current)==null||e.setEnableSpring(d):(n=r.current)==null||n.setEnableSpring(!0)},[d]),t.useEffect(()=>{var e,n;m!==void 0?(e=r.current)==null||e.setEnableScale(m):(n=r.current)==null||n.setEnableScale(!0)},[m]),t.useEffect(()=>{var e;(e=r.current)==null||e.setEnableBlur(l??!0)},[l]),t.useEffect(()=>{var e,n,s,w;F!==void 0?((e=r.current)==null||e.setLyricLines(F),(n=r.current)==null||n.update()):((s=r.current)==null||s.setLyricLines([]),(w=r.current)==null||w.update())},[F]),t.useEffect(()=>{var e,n;B!==void 0?(e=r.current)==null||e.setCurrentTime(B):(n=r.current)==null||n.setCurrentTime(0)},[B]),t.useEffect(()=>{var e;h!==void 0&&((e=r.current)==null||e.setLinePosXSpringParams(h))},[h]),t.useEffect(()=>{var e;c!==void 0&&((e=r.current)==null||e.setLinePosYSpringParams(c))},[c]),t.useEffect(()=>{var e;a!==void 0&&((e=r.current)==null||e.setLineScaleSpringParams(a))},[a]),t.useEffect(()=>{var e;if(f){const n=s=>f(s);return(e=r.current)==null||e.addEventListener("line-click",n),()=>{var s;return(s=r.current)==null?void 0:s.removeEventListener("line-click",n)}}},[f]),t.useEffect(()=>{var e;if(o){const n=s=>o(s);return(e=r.current)==null||e.addEventListener("line-contextmenu",n),()=>{var s;return(s=r.current)==null?void 0:s.removeEventListener("line-contextmenu",n)}}},[o]),t.useImperativeHandle(y,()=>({wrapperEl:R.current,lyricPlayer:r.current}),[R.current,r.current]),A.jsxs(A.Fragment,{children:[A.jsx("div",{...x,ref:R}),(j=r.current)!=null&&j.getBottomLineElement()&&u?H.createPortal(u,(q=r.current)==null?void 0:q.getBottomLineElement()):null]})});exports.BackgroundRender=P;exports.LyricPlayer=T;
//# sourceMappingURL=amll-react.cjs.map
